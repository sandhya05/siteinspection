import { Injectable, Inject, PLATFORM_ID, Directive, Input, ElementRef, HostListener, NgModule, defineInjectable, inject } from '@angular/core';
import { isPlatformBrowser } from '@angular/common';

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
var SimpleSmoothScrollOption = /** @class */ (function () {
    function SimpleSmoothScrollOption(option) {
        /**
         * EasingFunctions - from https://gist.github.com/gre/1650294
         */
        this.EasingFunctions = {
            // no easing, no acceleration
            linear: function (t) { return t; },
            // accelerating from zero velocity
            easeInQuad: function (t) { return t * t; },
            // decelerating to zero velocity
            easeOutQuad: function (t) { return t * (2 - t); },
            // acceleration until halfway, then deceleration
            easeInOutQuad: function (t) { return t < .5 ? 2 * t * t : -1 + (4 - 2 * t) * t; },
            // accelerating from zero velocity
            easeInCubic: function (t) { return t * t * t; },
            // decelerating to zero velocity
            easeOutCubic: function (t) { return (--t) * t * t + 1; },
            // acceleration until halfway, then deceleration
            easeInOutCubic: function (t) { return t < .5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1; },
            // accelerating from zero velocity
            easeInQuart: function (t) { return t * t * t * t; },
            // decelerating to zero velocity
            easeOutQuart: function (t) { return 1 - (--t) * t * t * t; },
            // acceleration until halfway, then deceleration
            easeInOutQuart: function (t) { return t < .5 ? 8 * t * t * t * t : 1 - 8 * (--t) * t * t * t; },
            // accelerating from zero velocity
            easeInQuint: function (t) { return t * t * t * t * t; },
            // decelerating to zero velocity
            easeOutQuint: function (t) { return 1 + (--t) * t * t * t * t; },
            // acceleration until halfway, then deceleration
            easeInOutQuint: function (t) { return t < .5 ? 16 * t * t * t * t * t : 1 + 16 * (--t) * t * t * t * t; }
        };
        this.duration = option.duration || 800;
        this.offset = option.offset || 0;
        this.easing = this.EasingFunctions[option.easing] || this.EasingFunctions['easeInOutQuad'];
    }
    return SimpleSmoothScrollOption;
}());
var SimpleSmoothScrollService = /** @class */ (function () {
    function SimpleSmoothScrollService(platformId) {
        this.platformId = platformId;
    }
    /**
     * @param {?} height
     * @param {?} opt
     * @return {?}
     */
    SimpleSmoothScrollService.prototype.smoothScroll = /**
     * @param {?} height
     * @param {?} opt
     * @return {?}
     */
    function (height, opt) {
        if (isPlatformBrowser(this.platformId)) {
            /** @type {?} */
            var option_1 = new SimpleSmoothScrollOption(opt);
            /** @type {?} */
            var duration = option_1.duration;
            /** @type {?} */
            var doc = document.documentElement;
            /** @type {?} */
            var begin_1 = (window.pageYOffset || doc.scrollTop) - (doc.clientTop || 0);
            /** @type {?} */
            var t = 10;
            /** @type {?} */
            var tick_1 = 1 / (duration / t);
            height += option_1.offset;
            /** @type {?} */
            var distance_1 = height - begin_1;
            if (distance_1 == 0)
                return;
            /** @type {?} */
            var time_1 = 0;
            /** @type {?} */
            var y_1 = void 0;
            /** @type {?} */
            var current_1 = void 0;
            /** @type {?} */
            var s_1 = setInterval(function () {
                y_1 = option_1.easing(time_1);
                current_1 = y_1 * distance_1 + begin_1;
                if (current_1 >= height && distance_1 > 0) {
                    current_1 = height;
                    clearInterval(s_1);
                }
                if (current_1 < height + tick_1 && distance_1 < 0) {
                    current_1 = height;
                    clearInterval(s_1);
                }
                if (current_1 < 0 && distance_1 < 0) {
                    current_1 = 0;
                    clearInterval(s_1);
                }
                window.scrollTo(0, current_1);
                time_1 += tick_1;
            }, t);
        }
    };
    /**
     * @param {?=} opt
     * @return {?}
     */
    SimpleSmoothScrollService.prototype.smoothScrollToTop = /**
     * @param {?=} opt
     * @return {?}
     */
    function (opt) {
        if (opt === void 0) { opt = {}; }
        this.smoothScroll(0, opt);
    };
    /**
     * @param {?=} opt
     * @return {?}
     */
    SimpleSmoothScrollService.prototype.smoothScrollToAnchor = /**
     * @param {?=} opt
     * @return {?}
     */
    function (opt) {
        if (opt === void 0) { opt = {}; }
        if (isPlatformBrowser(this.platformId)) {
            /** @type {?} */
            var eid = window.location.hash;
            if (eid)
                eid = eid.replace('#', '');
            /** @type {?} */
            var target = document.getElementById(eid);
            if (target)
                this.smoothScroll(target.offsetTop, opt);
        }
    };
    SimpleSmoothScrollService.decorators = [
        { type: Injectable, args: [{
                    providedIn: 'root'
                },] }
    ];
    /** @nocollapse */
    SimpleSmoothScrollService.ctorParameters = function () { return [
        { type: Object, decorators: [{ type: Inject, args: [PLATFORM_ID,] }] }
    ]; };
    /** @nocollapse */ SimpleSmoothScrollService.ngInjectableDef = defineInjectable({ factory: function SimpleSmoothScrollService_Factory() { return new SimpleSmoothScrollService(inject(PLATFORM_ID)); }, token: SimpleSmoothScrollService, providedIn: "root" });
    return SimpleSmoothScrollService;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
var SimpleSmoothScrollDirective = /** @class */ (function () {
    function SimpleSmoothScrollDirective(el, smooth, platformId) {
        this.el = el;
        this.smooth = smooth;
        this.platformId = platformId;
    }
    /**
     * @return {?}
     */
    SimpleSmoothScrollDirective.prototype.onClick = /**
     * @return {?}
     */
    function () {
        if (isPlatformBrowser(this.platformId)) {
            /** @type {?} */
            var eid = this.el.nativeElement.hash;
            if (eid) {
                if (this.showHash) {
                    // Change URL hash without page jump
                    history.pushState(null, null, eid);
                }
                eid = eid.replace('#', '');
            }
            /** @type {?} */
            var target = document.getElementById(eid) || document.getElementById(this.scrollTo);
            if (target)
                this.smooth.smoothScroll(target.offsetTop, { duration: this.duration, easing: this.easing, offset: this.offset });
            return false;
        }
    };
    SimpleSmoothScrollDirective.decorators = [
        { type: Directive, args: [{
                    selector: '[SimpleSmoothScroll]'
                },] }
    ];
    /** @nocollapse */
    SimpleSmoothScrollDirective.ctorParameters = function () { return [
        { type: ElementRef },
        { type: SimpleSmoothScrollService },
        { type: Object, decorators: [{ type: Inject, args: [PLATFORM_ID,] }] }
    ]; };
    SimpleSmoothScrollDirective.propDecorators = {
        scrollTo: [{ type: Input, args: ['scrollTo',] }],
        duration: [{ type: Input, args: ['duration',] }],
        offset: [{ type: Input, args: ['offset',] }],
        easing: [{ type: Input, args: ['easing',] }],
        showHash: [{ type: Input, args: ['showHash',] }],
        onClick: [{ type: HostListener, args: ['click',] }]
    };
    return SimpleSmoothScrollDirective;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
var SimpleSmoothScrollModule = /** @class */ (function () {
    function SimpleSmoothScrollModule() {
    }
    SimpleSmoothScrollModule.decorators = [
        { type: NgModule, args: [{
                    declarations: [SimpleSmoothScrollDirective],
                    providers: [SimpleSmoothScrollService],
                    exports: [SimpleSmoothScrollDirective]
                },] }
    ];
    return SimpleSmoothScrollModule;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */

export { SimpleSmoothScrollOption, SimpleSmoothScrollService, SimpleSmoothScrollDirective, SimpleSmoothScrollModule };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmcyLXNpbXBsZS1zbW9vdGgtc2Nyb2xsLmpzLm1hcCIsInNvdXJjZXMiOlsibmc6Ly9uZzItc2ltcGxlLXNtb290aC1zY3JvbGwvbGliL25nMi1zaW1wbGUtc21vb3RoLXNjcm9sbC5zZXJ2aWNlLnRzIiwibmc6Ly9uZzItc2ltcGxlLXNtb290aC1zY3JvbGwvbGliL25nMi1zaW1wbGUtc21vb3RoLXNjcm9sbC5kaXJlY3RpdmUudHMiLCJuZzovL25nMi1zaW1wbGUtc21vb3RoLXNjcm9sbC9saWIvbmcyLXNpbXBsZS1zbW9vdGgtc2Nyb2xsLm1vZHVsZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlLCBJbmplY3QsIFBMQVRGT1JNX0lEIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBpc1BsYXRmb3JtQnJvd3NlciB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVNpbXBsZVNtb290aFNjcm9sbE9wdGlvbiB7XG4gIGR1cmF0aW9uPzogbnVtYmVyO1xuICBlYXNpbmc/OiAnbGluZWFyJyB8ICdlYXNlSW5RdWFkJyB8ICdlYXNlT3V0UXVhZCcgfCAnZWFzZUluT3V0UXVhZCcgfCAnZWFzZUluQ3ViaWMnIHwgJ2Vhc2VPdXRDdWJpYycgfCAnZWFzZUluT3V0Q3ViaWMnIHwgJ2Vhc2VJblF1YXJ0JyB8ICdlYXNlT3V0UXVhcnQnIHwgJ2Vhc2VJbk91dFF1YXJ0JyB8ICdlYXNlSW5RdWludCcgfCAnZWFzZU91dFF1aW50JyB8ICdlYXNlSW5PdXRRdWludCc7XG4gIG9mZnNldD86IG51bWJlcjtcbn1cblxuZXhwb3J0IGNsYXNzIFNpbXBsZVNtb290aFNjcm9sbE9wdGlvbiB7XG4gIHB1YmxpYyBkdXJhdGlvbjogbnVtYmVyO1xuICBwdWJsaWMgZWFzaW5nOiBhbnk7XG4gIHB1YmxpYyBvZmZzZXQ6IGFueTtcblxuICBjb25zdHJ1Y3RvcihvcHRpb246IElTaW1wbGVTbW9vdGhTY3JvbGxPcHRpb24pIHtcbiAgICB0aGlzLmR1cmF0aW9uID0gb3B0aW9uLmR1cmF0aW9uIHx8IDgwMDtcbiAgICB0aGlzLm9mZnNldCA9IG9wdGlvbi5vZmZzZXQgfHwgMDtcbiAgICB0aGlzLmVhc2luZyA9IHRoaXMuRWFzaW5nRnVuY3Rpb25zW29wdGlvbi5lYXNpbmddIHx8IHRoaXMuRWFzaW5nRnVuY3Rpb25zWydlYXNlSW5PdXRRdWFkJ107XG4gIH1cblxuICAvKipcbiAgICogRWFzaW5nRnVuY3Rpb25zIC0gZnJvbSBodHRwczovL2dpc3QuZ2l0aHViLmNvbS9ncmUvMTY1MDI5NFxuICAgKi9cbiAgcHJpdmF0ZSBFYXNpbmdGdW5jdGlvbnMgPSB7XG4gICAgLy8gbm8gZWFzaW5nLCBubyBhY2NlbGVyYXRpb25cbiAgICBsaW5lYXI6ICh0KSA9PiB7IHJldHVybiB0IH0sXG4gICAgLy8gYWNjZWxlcmF0aW5nIGZyb20gemVybyB2ZWxvY2l0eVxuICAgIGVhc2VJblF1YWQ6ICh0KSA9PiB7IHJldHVybiB0ICogdCB9LFxuICAgIC8vIGRlY2VsZXJhdGluZyB0byB6ZXJvIHZlbG9jaXR5XG4gICAgZWFzZU91dFF1YWQ6ICh0KSA9PiB7IHJldHVybiB0ICogKDIgLSB0KSB9LFxuICAgIC8vIGFjY2VsZXJhdGlvbiB1bnRpbCBoYWxmd2F5LCB0aGVuIGRlY2VsZXJhdGlvblxuICAgIGVhc2VJbk91dFF1YWQ6ICh0KSA9PiB7IHJldHVybiB0IDwgLjUgPyAyICogdCAqIHQgOiAtMSArICg0IC0gMiAqIHQpICogdCB9LFxuICAgIC8vIGFjY2VsZXJhdGluZyBmcm9tIHplcm8gdmVsb2NpdHkgXG4gICAgZWFzZUluQ3ViaWM6ICh0KSA9PiB7IHJldHVybiB0ICogdCAqIHQgfSxcbiAgICAvLyBkZWNlbGVyYXRpbmcgdG8gemVybyB2ZWxvY2l0eSBcbiAgICBlYXNlT3V0Q3ViaWM6ICh0KSA9PiB7IHJldHVybiAoLS10KSAqIHQgKiB0ICsgMSB9LFxuICAgIC8vIGFjY2VsZXJhdGlvbiB1bnRpbCBoYWxmd2F5LCB0aGVuIGRlY2VsZXJhdGlvbiBcbiAgICBlYXNlSW5PdXRDdWJpYzogKHQpID0+IHsgcmV0dXJuIHQgPCAuNSA/IDQgKiB0ICogdCAqIHQgOiAodCAtIDEpICogKDIgKiB0IC0gMikgKiAoMiAqIHQgLSAyKSArIDEgfSxcbiAgICAvLyBhY2NlbGVyYXRpbmcgZnJvbSB6ZXJvIHZlbG9jaXR5IFxuICAgIGVhc2VJblF1YXJ0OiAodCkgPT4geyByZXR1cm4gdCAqIHQgKiB0ICogdCB9LFxuICAgIC8vIGRlY2VsZXJhdGluZyB0byB6ZXJvIHZlbG9jaXR5IFxuICAgIGVhc2VPdXRRdWFydDogKHQpID0+IHsgcmV0dXJuIDEgLSAoLS10KSAqIHQgKiB0ICogdCB9LFxuICAgIC8vIGFjY2VsZXJhdGlvbiB1bnRpbCBoYWxmd2F5LCB0aGVuIGRlY2VsZXJhdGlvblxuICAgIGVhc2VJbk91dFF1YXJ0OiAodCkgPT4geyByZXR1cm4gdCA8IC41ID8gOCAqIHQgKiB0ICogdCAqIHQgOiAxIC0gOCAqICgtLXQpICogdCAqIHQgKiB0IH0sXG4gICAgLy8gYWNjZWxlcmF0aW5nIGZyb20gemVybyB2ZWxvY2l0eVxuICAgIGVhc2VJblF1aW50OiAodCkgPT4geyByZXR1cm4gdCAqIHQgKiB0ICogdCAqIHQgfSxcbiAgICAvLyBkZWNlbGVyYXRpbmcgdG8gemVybyB2ZWxvY2l0eVxuICAgIGVhc2VPdXRRdWludDogKHQpID0+IHsgcmV0dXJuIDEgKyAoLS10KSAqIHQgKiB0ICogdCAqIHQgfSxcbiAgICAvLyBhY2NlbGVyYXRpb24gdW50aWwgaGFsZndheSwgdGhlbiBkZWNlbGVyYXRpb24gXG4gICAgZWFzZUluT3V0UXVpbnQ6ICh0KSA9PiB7IHJldHVybiB0IDwgLjUgPyAxNiAqIHQgKiB0ICogdCAqIHQgKiB0IDogMSArIDE2ICogKC0tdCkgKiB0ICogdCAqIHQgKiB0IH1cbiAgfVxufVxuXG5ASW5qZWN0YWJsZSh7XG4gIHByb3ZpZGVkSW46ICdyb290J1xufSlcbmV4cG9ydCBjbGFzcyBTaW1wbGVTbW9vdGhTY3JvbGxTZXJ2aWNlIHtcblxuICBjb25zdHJ1Y3RvcihASW5qZWN0KFBMQVRGT1JNX0lEKSBwcml2YXRlIHBsYXRmb3JtSWQ6IE9iamVjdCkgeyB9XG5cbiAgcHVibGljIHNtb290aFNjcm9sbChoZWlnaHQ6IG51bWJlciwgb3B0OiBJU2ltcGxlU21vb3RoU2Nyb2xsT3B0aW9uKSB7XG4gICAgaWYgKGlzUGxhdGZvcm1Ccm93c2VyKHRoaXMucGxhdGZvcm1JZCkpIHtcbiAgICAgIGNvbnN0IG9wdGlvbiA9IG5ldyBTaW1wbGVTbW9vdGhTY3JvbGxPcHRpb24ob3B0KTtcbiAgICAgIGNvbnN0IGR1cmF0aW9uID0gb3B0aW9uLmR1cmF0aW9uO1xuICAgICAgY29uc3QgZG9jID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50O1xuICAgICAgY29uc3QgYmVnaW4gPSAod2luZG93LnBhZ2VZT2Zmc2V0IHx8IGRvYy5zY3JvbGxUb3ApIC0gKGRvYy5jbGllbnRUb3AgfHwgMCk7XG4gICAgICBjb25zdCB0ID0gMTA7XG4gICAgICBjb25zdCB0aWNrID0gMSAvIChkdXJhdGlvbiAvIHQpO1xuICAgICAgaGVpZ2h0ICs9IG9wdGlvbi5vZmZzZXQ7XG4gICAgICBjb25zdCBkaXN0YW5jZSA9IGhlaWdodCAtIGJlZ2luO1xuICAgICAgaWYgKGRpc3RhbmNlID09IDApIHJldHVybjtcbiAgICAgIGxldCB0aW1lID0gMDtcbiAgICAgIGxldCB5LCBjdXJyZW50O1xuICAgICAgbGV0IHMgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHkgPSBvcHRpb24uZWFzaW5nKHRpbWUpO1xuICAgICAgICBjdXJyZW50ID0geSAqIGRpc3RhbmNlICsgYmVnaW47XG4gICAgICAgIGlmIChjdXJyZW50ID49IGhlaWdodCAmJiBkaXN0YW5jZSA+IDApIHtcbiAgICAgICAgICBjdXJyZW50ID0gaGVpZ2h0O1xuICAgICAgICAgIGNsZWFySW50ZXJ2YWwocyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGN1cnJlbnQgPCBoZWlnaHQgKyB0aWNrICYmIGRpc3RhbmNlIDwgMCkge1xuICAgICAgICAgIGN1cnJlbnQgPSBoZWlnaHQ7XG4gICAgICAgICAgY2xlYXJJbnRlcnZhbChzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY3VycmVudCA8IDAgJiYgZGlzdGFuY2UgPCAwKSB7XG4gICAgICAgICAgY3VycmVudCA9IDA7XG4gICAgICAgICAgY2xlYXJJbnRlcnZhbChzKTtcbiAgICAgICAgfVxuICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgY3VycmVudCk7XG4gICAgICAgIHRpbWUgKz0gdGljaztcbiAgICAgIH0sIHQpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBzbW9vdGhTY3JvbGxUb1RvcChvcHQ6IElTaW1wbGVTbW9vdGhTY3JvbGxPcHRpb24gPSB7fSkge1xuICAgIHRoaXMuc21vb3RoU2Nyb2xsKDAsIG9wdCk7XG4gIH1cblxuICBwdWJsaWMgc21vb3RoU2Nyb2xsVG9BbmNob3Iob3B0OiBJU2ltcGxlU21vb3RoU2Nyb2xsT3B0aW9uID0ge30pIHtcbiAgICBpZiAoaXNQbGF0Zm9ybUJyb3dzZXIodGhpcy5wbGF0Zm9ybUlkKSkge1xuICAgICAgbGV0IGVpZCA9IHdpbmRvdy5sb2NhdGlvbi5oYXNoO1xuICAgICAgaWYgKGVpZClcbiAgICAgICAgZWlkID0gZWlkLnJlcGxhY2UoJyMnLCAnJyk7XG4gICAgICBsZXQgdGFyZ2V0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZWlkKTtcbiAgICAgIGlmICh0YXJnZXQpXG4gICAgICAgIHRoaXMuc21vb3RoU2Nyb2xsKHRhcmdldC5vZmZzZXRUb3AsIG9wdCk7XG4gICAgfVxuICB9XG59IiwiaW1wb3J0IHsgRGlyZWN0aXZlLCBJbnB1dCwgRWxlbWVudFJlZiwgSG9zdExpc3RlbmVyLCBJbmplY3QsIFBMQVRGT1JNX0lEIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBpc1BsYXRmb3JtQnJvd3NlciB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQgeyBTaW1wbGVTbW9vdGhTY3JvbGxTZXJ2aWNlIH0gZnJvbSAnLi9uZzItc2ltcGxlLXNtb290aC1zY3JvbGwuc2VydmljZSc7XG5cbkBEaXJlY3RpdmUoe1xuICBzZWxlY3RvcjogJ1tTaW1wbGVTbW9vdGhTY3JvbGxdJ1xufSlcbmV4cG9ydCBjbGFzcyBTaW1wbGVTbW9vdGhTY3JvbGxEaXJlY3RpdmUge1xuICBASW5wdXQoJ3Njcm9sbFRvJykgcHJpdmF0ZSBzY3JvbGxUbzogc3RyaW5nO1xuICBASW5wdXQoJ2R1cmF0aW9uJykgcHJpdmF0ZSBkdXJhdGlvbjogbnVtYmVyO1xuICBASW5wdXQoJ29mZnNldCcpIHByaXZhdGUgb2Zmc2V0OiBudW1iZXI7XG4gIEBJbnB1dCgnZWFzaW5nJykgcHJpdmF0ZSBlYXNpbmc6ICdsaW5lYXInIHwgJ2Vhc2VJblF1YWQnIHwgJ2Vhc2VPdXRRdWFkJyB8ICdlYXNlSW5PdXRRdWFkJyB8ICdlYXNlSW5DdWJpYycgfCAnZWFzZU91dEN1YmljJyB8ICdlYXNlSW5PdXRDdWJpYycgfCAnZWFzZUluUXVhcnQnIHwgJ2Vhc2VPdXRRdWFydCcgfCAnZWFzZUluT3V0UXVhcnQnIHwgJ2Vhc2VJblF1aW50JyB8ICdlYXNlT3V0UXVpbnQnIHwgJ2Vhc2VJbk91dFF1aW50JztcbiAgQElucHV0KCdzaG93SGFzaCcpIHByaXZhdGUgc2hvd0hhc2g6IGJvb2xlYW47XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSBlbDogRWxlbWVudFJlZixcbiAgICBwcml2YXRlIHNtb290aDogU2ltcGxlU21vb3RoU2Nyb2xsU2VydmljZSxcbiAgICBASW5qZWN0KFBMQVRGT1JNX0lEKSBwcml2YXRlIHBsYXRmb3JtSWQ6IE9iamVjdCxcbiAgKSB7IH1cblxuICBASG9zdExpc3RlbmVyKCdjbGljaycpIG9uQ2xpY2soKSB7XG4gICAgaWYgKGlzUGxhdGZvcm1Ccm93c2VyKHRoaXMucGxhdGZvcm1JZCkpIHtcbiAgICAgIGxldCBlaWQgPSB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQuaGFzaDtcbiAgICAgIGlmIChlaWQpIHtcbiAgICAgICAgaWYgKHRoaXMuc2hvd0hhc2gpIHtcbiAgICAgICAgICAvLyBDaGFuZ2UgVVJMIGhhc2ggd2l0aG91dCBwYWdlIGp1bXBcbiAgICAgICAgICBoaXN0b3J5LnB1c2hTdGF0ZShudWxsLCBudWxsLCBlaWQpO1xuICAgICAgICB9XG4gICAgICAgIGVpZCA9IGVpZC5yZXBsYWNlKCcjJywgJycpO1xuICAgICAgfVxuICAgICAgbGV0IHRhcmdldCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGVpZCkgfHwgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5zY3JvbGxUbyk7XG4gICAgICBpZiAodGFyZ2V0KVxuICAgICAgICB0aGlzLnNtb290aC5zbW9vdGhTY3JvbGwodGFyZ2V0Lm9mZnNldFRvcCwgeyBkdXJhdGlvbjogdGhpcy5kdXJhdGlvbiwgZWFzaW5nOiB0aGlzLmVhc2luZywgb2Zmc2V0OiB0aGlzLm9mZnNldCB9KTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCB7IE5nTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBTaW1wbGVTbW9vdGhTY3JvbGxTZXJ2aWNlIH0gZnJvbSAnLi9uZzItc2ltcGxlLXNtb290aC1zY3JvbGwuc2VydmljZSc7XG5pbXBvcnQgeyBTaW1wbGVTbW9vdGhTY3JvbGxEaXJlY3RpdmUgfSBmcm9tICcuL25nMi1zaW1wbGUtc21vb3RoLXNjcm9sbC5kaXJlY3RpdmUnO1xuXG5ATmdNb2R1bGUoe1xuICBkZWNsYXJhdGlvbnM6IFtTaW1wbGVTbW9vdGhTY3JvbGxEaXJlY3RpdmVdLFxuICBwcm92aWRlcnM6IFtTaW1wbGVTbW9vdGhTY3JvbGxTZXJ2aWNlXSxcbiAgZXhwb3J0czogW1NpbXBsZVNtb290aFNjcm9sbERpcmVjdGl2ZV1cbn0pXG5leHBvcnQgY2xhc3MgU2ltcGxlU21vb3RoU2Nyb2xsTW9kdWxlIHsgfVxuIl0sIm5h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